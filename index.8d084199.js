!function(){function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function e(e,r){if(e){if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,r)}}function r(r){return function(e){if(Array.isArray(e))return t(e)}(r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||e(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var n=function(t){if(0===t.length)return null;var e=Math.floor(Math.random()*t.length);return t[e]},o=function(t,e){for(var r=t.filter(function(t){return 0!==t}),n=t.length-r.length;n>0;)e?r.push(0):r.unshift(0),n--;return r},i=function(t){return t[0].map(function(e,r){return t.map(function(t){return t[r]})})},a=new(function(){var t;function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,a),this.initialState=t,this.state=t.map(function(t){return t.slice()}),this.status="idle",this.score=0}return t=[{key:"move",value:function(t,e){"playing"===this.getStatus()&&this[t](e)&&this.setCell(n(this.getFreeCells()))}},{key:"moveLeft",value:function(){this.move("collapseRow",!0)}},{key:"moveRight",value:function(){this.move("collapseRow",!1)}},{key:"moveUp",value:function(){this.move("collapseColumn",!0)}},{key:"moveDown",value:function(){this.move("collapseColumn",!1)}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.state}},{key:"getStatus",value:function(){return this.status}},{key:"getFreeCells",value:function(){var t=this.getState(),e=[],r=!0,n=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(r=(i=a.next()).done);r=!0)!function(){var r=i.value;r.forEach(function(n,o){0===n&&e.push([t.indexOf(r),o])})}()}catch(t){n=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(n)throw o}}return e}},{key:"setCell",value:function(t){if(t){var r,n=function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r,n,o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var i=[],a=!0,l=!1;try{for(o=o.call(t);!(a=(r=o.next()).done)&&(i.push(r.value),2!==i.length);a=!0);}catch(t){l=!0,n=t}finally{try{a||null==o.return||o.return()}finally{if(l)throw n}}return i}}(t,2)||e(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),o=n[0],i=n[1];r=.9>Math.random()?2:4,this.state[o][i]=r}}},{key:"updateField",value:function(t){var e=this.getState(),n=!0,o=!1,i=void 0;try{for(var a,l=t.children[Symbol.iterator]();!(n=(a=l.next()).done);n=!0){var s=a.value,u=r(t.children).indexOf(s),c=!0,f=!1,h=void 0;try{for(var y,v=s.cells[Symbol.iterator]();!(c=(y=v.next()).done);c=!0){var d=y.value,m=r(s.cells).indexOf(d),g=e[u][m];d.textContent=g||"",d.classList="field-cell field-cell--".concat(g||"")}}catch(t){f=!0,h=t}finally{try{c||null==v.return||v.return()}finally{if(f)throw h}}}}catch(t){o=!0,i=t}finally{try{n||null==l.return||l.return()}finally{if(o)throw i}}}},{key:"collapse",value:function(t,e){var r=[],n=0;if(e)for(var o=0;o<t.length;o++)t[o]===t[o+1]?(r.push(2*t[o]),n+=2*t[o],o++):r.push(t[o]);else for(var i=t.length-1;i>=0;i--)t[i]===t[i-1]?(r.unshift(2*t[i]),n+=2*t[i],i--):r.unshift(t[i]);for(;r.length<t.length;)e?r.push(0):r.unshift(0);return this.score+=n,r}},{key:"collapseRow",value:function(){var t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],e=this.getState(),r=[],n=!0,i=!1,a=void 0;try{for(var l,s=e[Symbol.iterator]();!(n=(l=s.next()).done);n=!0){var u=l.value,c=o(u,t),f=this.collapse(c,t);r.push(f)}}catch(t){i=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return JSON.stringify(e)!==JSON.stringify(r)&&(this.state=r,!0)}},{key:"collapseColumn",value:function(){var t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],e=i(this.getState()),r=[],n=!0,a=!1,l=void 0;try{for(var s,u=e[Symbol.iterator]();!(n=(s=u.next()).done);n=!0){var c=s.value,f=o(c,t),h=this.collapse(f,t);r.push(h)}}catch(t){a=!0,l=t}finally{try{n||null==u.return||u.return()}finally{if(a)throw l}}return JSON.stringify(e)!==JSON.stringify(r)&&(this.state=i(r),!0)}},{key:"isMovesPossible",value:function(){var t=this.getState(),e=i(this.getState());if(this.getFreeCells().length)return!0;for(var r=0;r<t.length;r++){var n=function(r){var n=t[r],o=e[r],i=o.some(function(t,e){return t===o[e+1]});if(n.some(function(t,e){return t===n[e+1]})||i)return{v:!0}}(r);if("object"==(n&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n))return n.v}return!1}},{key:"isWinning",value:function(){return this.getState().some(function(t){return t.some(function(t){return 2048===t})})}},{key:"start",value:function(){this.status="playing",this.setCell(n(this.getFreeCells())),this.setCell(n(this.getFreeCells()))}},{key:"restart",value:function(){this.status="idle",this.score=0,this.state=this.initialState.map(function(t){return t.slice()})}}],function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(a.prototype,t),a}())([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]),l=document.querySelector("body"),s=l.querySelector(".game-field tbody"),u=document.querySelector("button.start"),c=document.querySelector(".message-start"),f=document.querySelector(".message-win"),h=document.querySelector(".message-lose"),y=document.querySelector(".game-score");l.addEventListener("keydown",function(t){switch(t.key){case"ArrowLeft":a.moveLeft(),a.updateField(s);break;case"ArrowRight":a.moveRight(),a.updateField(s);break;case"ArrowUp":a.moveUp(),a.updateField(s);break;case"ArrowDown":a.moveDown(),a.updateField(s)}y.textContent=a.score,a.isMovesPossible()||(h.classList.remove("hidden"),a.status="lose"),a.isWinning()&&(f.classList.remove("hidden"),a.status="win")}),u.addEventListener("click",function(t){t.target.classList.contains("restart")?(a.restart(),t.target.classList="button start",t.target.textContent="Start",h.classList.add("hidden"),f.classList.add("hidden")):(a.start(),t.target.classList="button restart",t.target.textContent="Restart"),c.classList.toggle("hidden"),y.textContent=a.score,a.updateField(s)})}();
//# sourceMappingURL=index.8d084199.js.map
